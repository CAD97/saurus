[gd_scene load_steps=4 format=3 uid="uid://ds1p5u0p4svb"]

[ext_resource type="SpriteFrames" uid="uid://c4egarmbqfj78" path="res://characters/player/base.res" id="1_508ok"]

[sub_resource type="GDScript" id="GDScript_on558"]
resource_name = "Player"
script/source = "extends CharacterBody3D


@export var move_speed: float = 1.0

@onready var animated_sprite_3d: AnimatedSprite3D = %AnimatedSprite3D

var _move_intent: Vector2 = Vector2.ZERO


func _process(_delta: float) -> void:
	if _move_intent == Vector2.ZERO:
		match animated_sprite_3d.animation:
			&\"walk_down\": animated_sprite_3d.play(&\"idle_down\")
			&\"walk_left\": animated_sprite_3d.play(&\"idle_left\")
			&\"walk_right\": animated_sprite_3d.play(&\"idle_right\")
			&\"walk_up\": animated_sprite_3d.play(&\"idle_up\")
	else:
		if absf(_move_intent.x) <= absf(_move_intent.y):
			animated_sprite_3d.play(&\"walk_up\" if _move_intent.y < 0 else &\"walk_down\")
		else:
			animated_sprite_3d.play(&\"walk_left\" if _move_intent.x < 0 else &\"walk_right\")


func _physics_process(delta: float) -> void:
	_move_intent = Input.get_vector(\"move_left\", \"move_right\", \"move_up\", \"move_down\").normalized()
	if not is_on_floor():
		_move_intent = Vector2.ZERO
	velocity.x = _move_intent.x * move_speed
	velocity.z = _move_intent.y * move_speed
	velocity += get_gravity() * delta
	move_and_slide()

	if global_position.y < -20:
		global_position = Vector3(0, 20, 0)
"

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_xxgcw"]
radius = 0.6
height = 1.8

[node name="Player" type="CharacterBody3D"]
floor_constant_speed = true
floor_max_angle = 0.802851
floor_snap_length = 0.25
script = SubResource("GDScript_on558")
move_speed = 10.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.9, 0)
shape = SubResource("CapsuleShape3D_xxgcw")

[node name="AnimatedSprite3D" type="AnimatedSprite3D" parent="CollisionShape3D"]
unique_name_in_owner = true
pixel_size = 0.08
billboard = 1
texture_filter = 2
sprite_frames = ExtResource("1_508ok")
animation = &"idle_right"
