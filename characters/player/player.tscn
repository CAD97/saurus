[gd_scene load_steps=59 format=3 uid="uid://ds1p5u0p4svb"]

[ext_resource type="Texture2D" uid="uid://olcj6phtiowd" path="res://addons/kenney_rpg_urban_pack/tiles/tile_0105.png" id="2_xxgcw"]
[ext_resource type="Texture2D" uid="uid://cwt20pls40ikc" path="res://addons/kenney_rpg_urban_pack/tiles/tile_0132.png" id="3_gqopd"]
[ext_resource type="Texture2D" uid="uid://66iw23ga88qe" path="res://addons/kenney_rpg_urban_pack/tiles/tile_0159.png" id="4_icpky"]
[ext_resource type="Texture2D" uid="uid://bq0r0eqbo7mgx" path="res://addons/kenney_rpg_urban_pack/tiles/tile_0104.png" id="5_58jvb"]
[ext_resource type="Texture2D" uid="uid://c5fly8qfimqf5" path="res://addons/kenney_rpg_urban_pack/tiles/tile_0131.png" id="6_8l73k"]
[ext_resource type="Texture2D" uid="uid://4gkx35bit4gc" path="res://addons/kenney_rpg_urban_pack/tiles/tile_0158.png" id="7_aqrcq"]
[ext_resource type="Texture2D" uid="uid://kmvy5kgnk4n" path="res://addons/kenney_rpg_urban_pack/tiles/tile_0107.png" id="8_d2agh"]
[ext_resource type="Texture2D" uid="uid://2pf6k3uotb6s" path="res://addons/kenney_rpg_urban_pack/tiles/tile_0134.png" id="9_fpo3a"]
[ext_resource type="Texture2D" uid="uid://dfl4xm12rhw62" path="res://addons/kenney_rpg_urban_pack/tiles/tile_0161.png" id="10_kyfeq"]
[ext_resource type="Texture2D" uid="uid://buytel0yae7kd" path="res://addons/kenney_rpg_urban_pack/tiles/tile_0106.png" id="11_5mkjs"]
[ext_resource type="Texture2D" uid="uid://e88ea2wp81so" path="res://addons/kenney_rpg_urban_pack/tiles/tile_0133.png" id="12_yybc7"]
[ext_resource type="Texture2D" uid="uid://cyve4n0etcxpp" path="res://addons/kenney_rpg_urban_pack/tiles/tile_0160.png" id="13_lv4bx"]

[sub_resource type="GDScript" id="GDScript_on558"]
resource_name = "Player"
script/source = "extends CharacterBody3D


@export var move_speed: float = 1.0

var _move_intent: Vector2 = Vector2.ZERO


func _physics_process(delta: float) -> void:
	_move_intent = Input.get_vector(\"move_left\", \"move_right\", \"move_up\", \"move_down\").normalized()
	if not is_on_floor():
		_move_intent = Vector2.ZERO
	velocity.x = _move_intent.x * move_speed
	velocity.z = _move_intent.y * move_speed
	velocity += get_gravity() * delta
	move_and_slide()

	if global_position.y < -20:
		global_position = Vector3(0, 20, 0)
"

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_xxgcw"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_gqopd"]
animation = &"idle_down"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_icpky"]
animation = &"idle_left"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_58jvb"]
animation = &"idle_right"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_8l73k"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_aqrcq"]
transitions = ["Start", "End", SubResource("AnimationNodeStateMachineTransition_8l73k")]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_d2agh"]
animation = &"idle_up"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_fpo3a"]
animation = &"walk_down"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_kyfeq"]
animation = &"walk_left"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5mkjs"]
animation = &"walk_right"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_yybc7"]
switch_mode = 1

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_lv4bx"]
transitions = ["Start", "End", SubResource("AnimationNodeStateMachineTransition_yybc7")]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_yybc7"]
animation = &"walk_up"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_lv4bx"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_jgd8i"]
advance_mode = 2
advance_expression = "not _move_intent.is_zero_approx()"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7b6hw"]
advance_mode = 2
advance_expression = "not _move_intent.is_zero_approx()"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_4cx7u"]
advance_mode = 2
advance_expression = "not _move_intent.is_zero_approx()"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_w53g3"]
advance_mode = 2
advance_expression = "not _move_intent.is_zero_approx()"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_gqopd"]
advance_mode = 2
advance_expression = "_move_intent.is_zero_approx()"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_icpky"]
advance_mode = 2
advance_expression = "_move_intent.is_zero_approx()"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_58jvb"]
advance_mode = 2
advance_expression = "_move_intent.is_zero_approx()"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_aqrcq"]
advance_mode = 2
advance_expression = "_move_intent.is_zero_approx()"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_d2agh"]
advance_mode = 2
advance_expression = "abs(_move_intent.y) < 0.5 and _move_intent.x < 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_fpo3a"]
advance_mode = 2
advance_expression = "abs(_move_intent.x) < 0.5 and _move_intent.y < 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_kyfeq"]
advance_mode = 2
advance_expression = "abs(_move_intent.y) < 0.5 and _move_intent.x > 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_5mkjs"]
advance_mode = 2
advance_expression = "abs(_move_intent.x) < 0.5 and _move_intent.y > 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_e0pgg"]
switch_mode = 1
advance_mode = 2
advance_expression = "abs(_move_intent.x) < 0.5 and _move_intent.y < 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_sbttr"]
switch_mode = 1
advance_mode = 2
advance_expression = "abs(_move_intent.y) < 0.5 and _move_intent.x < 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_6pj1p"]
switch_mode = 1
advance_mode = 2
advance_expression = "abs(_move_intent.x) < 0.5 and _move_intent.y > 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_3a7m8"]
switch_mode = 1
advance_mode = 2
advance_expression = "abs(_move_intent.y) < 0.5 and _move_intent.x > 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_y3et5"]
switch_mode = 1
advance_mode = 2
advance_expression = "(_move_intent.x <= 0 and not _move_intent.y == 0) or (_move_intent.x < 0.5 and abs(_move_intent.y) > 0.5)"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_0mbv2"]
switch_mode = 1
advance_mode = 2
advance_expression = "(_move_intent.y <= 0 and not _move_intent.x == 0) or (_move_intent.y < 0.5 and abs(_move_intent.x) > 0.5)"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_8v65i"]
switch_mode = 1
advance_mode = 2
advance_expression = "(_move_intent.x >= 0 and not _move_intent.y == 0) or (_move_intent.x > -0.5 and abs(_move_intent.y) > 0.5)"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_jepfe"]
switch_mode = 1
advance_mode = 2
advance_expression = "(_move_intent.y >= 0 and not _move_intent.x == 0) or (_move_intent.y > -0.5 and abs(_move_intent.x) > 0.5)"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_icpky"]
states/End/position = Vector2(-35, 261)
states/Start/position = Vector2(-35, 197)
states/idle_down/node = SubResource("AnimationNodeAnimation_gqopd")
states/idle_down/position = Vector2(122, 197)
states/idle_left/node = SubResource("AnimationNodeAnimation_icpky")
states/idle_left/position = Vector2(122, -28)
states/idle_right/node = SubResource("AnimationNodeAnimation_58jvb")
states/idle_right/position = Vector2(122, 100)
states/idle_to_walk/node = SubResource("AnimationNodeStateMachine_aqrcq")
states/idle_to_walk/position = Vector2(372, 51)
states/idle_up/node = SubResource("AnimationNodeAnimation_d2agh")
states/idle_up/position = Vector2(122, -153)
states/walk_down/node = SubResource("AnimationNodeAnimation_fpo3a")
states/walk_down/position = Vector2(542, 197)
states/walk_left/node = SubResource("AnimationNodeAnimation_kyfeq")
states/walk_left/position = Vector2(372, -28)
states/walk_right/node = SubResource("AnimationNodeAnimation_5mkjs")
states/walk_right/position = Vector2(862, 100)
states/walk_to_walk/node = SubResource("AnimationNodeStateMachine_lv4bx")
states/walk_to_walk/position = Vector2(724, -82)
states/walk_up/node = SubResource("AnimationNodeAnimation_yybc7")
states/walk_up/position = Vector2(542, -153)
transitions = ["Start", "idle_down", SubResource("AnimationNodeStateMachineTransition_lv4bx"), "idle_up", "idle_to_walk", SubResource("AnimationNodeStateMachineTransition_jgd8i"), "idle_left", "idle_to_walk", SubResource("AnimationNodeStateMachineTransition_7b6hw"), "idle_right", "idle_to_walk", SubResource("AnimationNodeStateMachineTransition_4cx7u"), "idle_down", "idle_to_walk", SubResource("AnimationNodeStateMachineTransition_w53g3"), "walk_left", "idle_left", SubResource("AnimationNodeStateMachineTransition_gqopd"), "walk_up", "idle_up", SubResource("AnimationNodeStateMachineTransition_icpky"), "walk_right", "idle_right", SubResource("AnimationNodeStateMachineTransition_58jvb"), "walk_down", "idle_down", SubResource("AnimationNodeStateMachineTransition_aqrcq"), "idle_to_walk", "walk_left", SubResource("AnimationNodeStateMachineTransition_d2agh"), "idle_to_walk", "walk_up", SubResource("AnimationNodeStateMachineTransition_fpo3a"), "idle_to_walk", "walk_right", SubResource("AnimationNodeStateMachineTransition_kyfeq"), "idle_to_walk", "walk_down", SubResource("AnimationNodeStateMachineTransition_5mkjs"), "walk_to_walk", "walk_up", SubResource("AnimationNodeStateMachineTransition_e0pgg"), "walk_to_walk", "walk_left", SubResource("AnimationNodeStateMachineTransition_sbttr"), "walk_to_walk", "walk_down", SubResource("AnimationNodeStateMachineTransition_6pj1p"), "walk_to_walk", "walk_right", SubResource("AnimationNodeStateMachineTransition_3a7m8"), "walk_right", "walk_to_walk", SubResource("AnimationNodeStateMachineTransition_y3et5"), "walk_down", "walk_to_walk", SubResource("AnimationNodeStateMachineTransition_0mbv2"), "walk_left", "walk_to_walk", SubResource("AnimationNodeStateMachineTransition_8v65i"), "walk_up", "walk_to_walk", SubResource("AnimationNodeStateMachineTransition_jepfe")]
graph_offset = Vector2(-576.25, -17.637367)

[sub_resource type="Animation" id="Animation_gqopd"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("2_xxgcw")]
}

[sub_resource type="Animation" id="Animation_8v65i"]
resource_name = "idle_down"
length = 0.2
loop_mode = 1
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("2_xxgcw")]
}

[sub_resource type="Animation" id="Animation_3a7m8"]
resource_name = "idle_left"
length = 0.2
loop_mode = 1
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("5_58jvb")]
}

[sub_resource type="Animation" id="Animation_y3et5"]
resource_name = "idle_right"
length = 0.2
loop_mode = 1
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("8_d2agh")]
}

[sub_resource type="Animation" id="Animation_0mbv2"]
resource_name = "idle_up"
length = 0.2
loop_mode = 1
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("11_5mkjs")]
}

[sub_resource type="Animation" id="Animation_58jvb"]
resource_name = "walk_down"
length = 0.8
loop_mode = 1
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [ExtResource("2_xxgcw"), ExtResource("3_gqopd"), ExtResource("2_xxgcw"), ExtResource("4_icpky")]
}

[sub_resource type="Animation" id="Animation_sbttr"]
resource_name = "walk_left"
length = 0.8
loop_mode = 1
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [ExtResource("5_58jvb"), ExtResource("6_8l73k"), ExtResource("5_58jvb"), ExtResource("7_aqrcq")]
}

[sub_resource type="Animation" id="Animation_6pj1p"]
resource_name = "walk_right"
length = 0.8
loop_mode = 1
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [ExtResource("8_d2agh"), ExtResource("9_fpo3a"), ExtResource("8_d2agh"), ExtResource("10_kyfeq")]
}

[sub_resource type="Animation" id="Animation_e0pgg"]
resource_name = "walk_up"
length = 0.8
loop_mode = 1
step = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite3D:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [ExtResource("11_5mkjs"), ExtResource("12_yybc7"), ExtResource("11_5mkjs"), ExtResource("13_lv4bx")]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_8l73k"]
_data = {
&"RESET": SubResource("Animation_gqopd"),
&"idle_down": SubResource("Animation_8v65i"),
&"idle_left": SubResource("Animation_3a7m8"),
&"idle_right": SubResource("Animation_y3et5"),
&"idle_up": SubResource("Animation_0mbv2"),
&"walk_down": SubResource("Animation_58jvb"),
&"walk_left": SubResource("Animation_sbttr"),
&"walk_right": SubResource("Animation_6pj1p"),
&"walk_up": SubResource("Animation_e0pgg")
}

[node name="Player" type="CharacterBody3D"]
floor_constant_speed = true
floor_max_angle = 0.802851
floor_snap_length = 0.25
script = SubResource("GDScript_on558")
move_speed = 10.0

[node name="Sprite3D" type="Sprite3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1.4, 0, 0, 0, 1, 0, 0, 0)
gi_mode = 2
centered = false
offset = Vector2(-8, 0)
pixel_size = 0.1
billboard = 2
texture_filter = 0
texture = ExtResource("2_xxgcw")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_xxgcw")

[node name="AnimationTree" type="AnimationTree" parent="."]
callback_mode_process = 0
tree_root = SubResource("AnimationNodeStateMachine_icpky")
advance_expression_base_node = NodePath("..")
anim_player = NodePath("../AnimationPlayer")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_8l73k")
}
