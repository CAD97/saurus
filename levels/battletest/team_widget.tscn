[gd_scene load_steps=7 format=3 uid="uid://d2305rus1upad"]

[ext_resource type="Texture2D" uid="uid://cw4bwhx1l1nmh" path="res://levels/battletest/action_widget_bg.png" id="1_ay6c3"]
[ext_resource type="Texture2D" uid="uid://6oo7hlqd1xqg" path="res://levels/battletest/action_bar_under.png" id="2_v6pwe"]
[ext_resource type="Texture2D" uid="uid://dqjkt4fr0efey" path="res://levels/battletest/action_bar_over.png" id="3_dluh2"]
[ext_resource type="Texture2D" uid="uid://dc6kf8r3pq1jh" path="res://levels/battletest/action_bar_progress.png" id="4_8etdv"]

[sub_resource type="GDScript" id="GDScript_mcdg0"]
resource_name = "TeamWidget"
script/source = "extends Control

const DINO_WIDGET := preload(\"uid://bbnfswcvaxdbp\") # dino_widget.tscn

@export_group(\"AP Tween\", \"_ap_tween_\")
@export var _ap_tween_trans: Tween.TransitionType
@export var _ap_tween_duration: float = 1

var ap: int:
	set(value):
		ap = clampi(value, 0, ap_max)
		%ActionLabel.text = str(ap)
		_ap_tween = create_tween()
		(_ap_tween
			.tween_property(%ActionBar, ^\"value\", ap, _ap_tween_duration)
			.from_current()
			.set_trans(_ap_tween_trans)
			.set_ease(Tween.EASE_OUT))
var ap_max: int:
	set(value):
		ap_max = value
		%ActionBar.max_value = ap_max

var _ap_tween: Tween:
	set(value):
		if _ap_tween: _ap_tween.kill()
		_ap_tween = value


func _ready() -> void:
	const LYSTROSAURUS := preload(\"uid://fg0xbpftcpeo\")
	add_dino(LYSTROSAURUS)
	add_dino(LYSTROSAURUS)
	add_dino(LYSTROSAURUS)
	ap_max = 20
	ap = 10


func add_dino(dino: DinoDef) -> DinoWidget:
	var widget = DINO_WIDGET.instantiate() as DinoWidget
	widget.dino = dino
	%TeamPreview.add_child(widget)
	return widget


func remove_dino(idx: int) -> void:
	%TeamPreview.remove_child(get_dino_widget(idx))


func set_dino(idx: int, dino: DinoDef) -> void:
	get_dino_widget(idx).dino = dino


func get_dino_widget(idx: int) -> DinoWidget:
	return %TeamPreview.get_child(idx) as DinoWidget
"

[sub_resource type="LabelSettings" id="LabelSettings_v6pwe"]
font_size = 104
outline_size = 20
outline_color = Color(0, 0, 0, 1)

[node name="TeamWidget" type="Control"]
layout_mode = 3
anchors_preset = 2
anchor_top = 1.0
anchor_bottom = 1.0
offset_top = -360.0
offset_right = 960.0
grow_vertical = 0
pivot_offset = Vector2(0, 360)
size_flags_horizontal = 0
size_flags_vertical = 8
script = SubResource("GDScript_mcdg0")
_ap_tween_trans = 5
_ap_tween_duration = 0.2

[node name="TeamPreview" type="VBoxContainer" parent="."]
unique_name_in_owner = true
layout_mode = 1
anchors_preset = -1
anchor_top = 0.6
anchor_bottom = 0.6
offset_top = -174.0
offset_bottom = -174.0
grow_vertical = 0

[node name="ActionWidget" type="TextureRect" parent="."]
layout_mode = 1
anchors_preset = 2
anchor_top = 1.0
anchor_bottom = 1.0
offset_top = -360.0
offset_right = 720.0
grow_vertical = 0
texture = ExtResource("1_ay6c3")

[node name="ActionBar" type="TextureProgressBar" parent="ActionWidget"]
unique_name_in_owner = true
layout_mode = 1
anchors_preset = -1
anchor_left = 0.2
anchor_top = 0.6
anchor_right = 1.3110001
anchor_bottom = 0.6
offset_top = -1.5258789e-05
offset_right = 0.07989502
offset_bottom = 89.999985
grow_horizontal = 2
grow_vertical = 2
value = 50.0
texture_under = ExtResource("2_v6pwe")
texture_over = ExtResource("3_dluh2")
texture_progress = ExtResource("4_8etdv")

[node name="ActionLabel" type="Label" parent="ActionWidget"]
unique_name_in_owner = true
auto_translate_mode = 2
layout_mode = 1
anchors_preset = -1
anchor_left = 0.2
anchor_top = 0.6
anchor_right = 0.2
anchor_bottom = 0.6
offset_top = -143.0
offset_right = 59.0
text = "100"
label_settings = SubResource("LabelSettings_v6pwe")
horizontal_alignment = 3
vertical_alignment = 3
